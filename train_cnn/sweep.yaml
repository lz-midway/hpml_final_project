# sweep.yaml
program: train.py
method: grid
metric:
  name: val_accuracy
  goal: maximize

parameters:
  model_name:
    value: "Modular-CVNN"
  gpu-type:
    value: "RTX 5090"
  batch_size:
    value: 64
  lr:
    value: 1e-4
  optimizer:
    value: Adam
  num_workers:
    value: 4
  filter_dimension:
    value: 3
  epochs:
    value: 1000
  compile:
    value: true
  log_interval:
    value: 10
  save_every:
    value: 50
  checkpoint_path:
    value: "checkpoint.pt"
  resume:
    value: false

  # Sweep over conv/residual blocks
  model_config:
    parameters:
      conv1:
        value: "binary"
      conv2:
        value: "binary"
      conv3:
        value: "binary"
      conv4:
        value: "binary"
      conv5:
        value: "binary"
      conv6:
        value: "binary"
      conv7:
        value: "binary"
      conv8:
        value: "binary"
      conv9:
        value: "binary"
      conv10:
        values: ["real", "binary"]
      fc1:
        value: "binary"
      fc2:
        value: "binary"
      final:
        value: "binary"
